<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>SIGTAREFAS</title>
</h:head>
<h:body>
    <p:growl id="messages" showDetail="true" life="3000"/>
    <h:form>
        <p:panel header="Nova Tarefa">
            <h:panelGrid columns="2">
                <p:outputLabel for="title" value="Título:"/>
                <p:inputText id="title" value="#{taskMB.task.title}" required="true"/>

                <p:outputLabel for="description" value="Descrição:"/>
                <p:inputTextarea id="description" value="#{taskMB.task.description}"/>

                <p:outputLabel for="assignee" value="Responsável:"/>
                <p:inputText id="assignee" value="#{taskMB.task.assignee}"/>

                <p:outputLabel for="priority" value="Prioridade:"/>
                <p:selectOneMenu id="priority" value="#{taskMB.task.priority}">
                    <f:selectItems value="#{taskMB.task.priority.values()}" var="p" itemLabel="#{p}" itemValue="#{p}"/>
                </p:selectOneMenu>

                <p:outputLabel for="date" value="Data:"/>
                <p:calendar id="date" value="#{taskMB.task.date}" showOn="button"/>

                <p:commandButton value="Salvar" actionListener="#{taskMB.save()}" update="@form messages">
                    <p:ajax oncomplete="PF('messages').renderMessage({summary:'Sucesso', detail:'Nova tarefa salva!', severity:'info'})"/>
                </p:commandButton>
            </h:panelGrid>
        </p:panel>
    </h:form>

    <h:form>
        <p:panel header="Lista de Tarefas">
            <p:dataTable value="#{taskMB.taskList}" var="task" emptyMessage="Nenhuma tarefa encontrada">
                <p:column headerText="ID">
                    #{task.id}
                </p:column>
                <p:column headerText="Título">
                    #{task.title}
                </p:column>
                <p:column headerText="Descrição">
                    #{task.description}
                </p:column>
                <p:column headerText="Prioridade">
                    #{task.priority}
                </p:column>
                <p:column headerText="Data">
                    <h:outputText value="#{task.date}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="Ações">
                    <p:commandButton value="Excluir" action="#{taskMB.delete(task)}" update="@form">
                        <f:setPropertyActionListener target="#{taskMB.task}" value="#{task}"/>
                    </p:commandButton>
                </p:column>
            </p:dataTable>
        </p:panel>
    </h:form>

</h:body>
</html>
